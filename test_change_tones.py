kids = array([ch.sweep.rf_freqs[j][nanargmax(abs(gradient(ch.sweep.data[j]) ))] for j in range(len(freqs))] ); change_toneslist_values.change_toneslist_freqs('/home/muscat/',kids,'/home/muscat/live_toneslist.toneslist'); change_toneslist_values.change_freqsfile_freqs('/home/muscat/live_freqsfile.txt',kids,'/home/muscat/live_freqsfile.txt'); ch.toneslist.tonelistfile = '/home/muscat/live_toneslist.toneslist'; ch.toneslist.tonelistfile = '/home/muscat/live_toneslist.toneslist'; ch.toneslist._bandwidth=512e6;ch.toneslist.load_tonelist(); ch.toneslist.bandwidth = 512e6; ch.toneslist.phases=phases; ch.toneslist.amp=ac; ch.toneslist.lo_freq = lo; ch.toneslist._update_frequencies(); ch.roach_iface.write_freqs_to_qdr(ch.toneslist.bb_freqs,wg*ac,phases,autoFullScale=False,dac_iq_phase=radians(0)*ones(len(freqs)),dac_iq_gain=ones(len(freqs))+1j*ones(len(freqs)),dds_iq_gain=(1+1j)*ones(len(freqs)),dds_iq_phase=radians(0)*ones(len(freqs)), dds_iq_offset = 0*ones(len(freqs)),dac_dither=False,dds_dither=False); fft_shift = 2**5; pcp.lib.lib_fpga.write_to_fpga_register(ch.roach_iface.fpga, { "fft_shift_reg": fft_shift - 1} , ch.roach_iface.firmware_reg_list,sleep_time =0.)